; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:main]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
; set baud rate
upload_speed = 115200
build_src_filter = +<*> -<tests/> # Build main code, exclude tests dir

# === Component/Unit Tests ===
[env:test_motion_input]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<tests/test_motion_input/>

[env:test_rfid_input]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<tests/test_rfid_input/>

[env:test_emergency_input]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<tests/test_emergency_input/>

[env:test_serial_output_m]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<tests/test_serial_output_m/>

[env:test_serial_output_r]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<tests/test_serial_output_r/>

[env:test_serial_output_e]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<tests/test_serial_output_e/>

[env:test_servo_pulse_output]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<tests/test_servo_pulse_output/>

# === Link/Integration Tests (Use Main Code) ===
# Note: These environments technically just build the main code.
# The difference is the *purpose* and *external setup* required for the test.
[env:test_mega_to_esp32_link]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<*> -<tests/> # Build main code

[env:test_mega_to_uno_link]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<*> -<tests/> # Build main code

[env:test_emergency_preemption]
platform = atmelavr
board = megaatmega2560
framework = arduino
monitor_speed = 115200
upload_speed = 115200
build_src_filter = +<*> -<tests/> # Build main code

# --- Remove or Comment Out Old Test Env ---
# [env:mega-to-esp32-uart-test]
# platform = atmelavr
# board = megaatmega2560
# framework = arduino
# monitor_speed = 115200
# ; set baud rate
# upload_speed = 115200
# build_src_filter = tests/mega-to-esp32-uart-test.cpp
